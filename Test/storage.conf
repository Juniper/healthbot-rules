## Last changed: 2018-03-16 14:47:41 UTC
version "18.1I20171121_0736_rsankar [rsankar]";
iceberg:iceberg {
    topic storage {
        rule storage {
            sensor StorageTable {
                iAgent {
                    file storage.yml;
                    table StorageTable;
                    frequency 10;
                }
            }
        field root {
                sensor StorageTable {
                    where "filesystem-name == '/dev/md0.uzip'";
                    path used-percent;
                }
            }
        field dev_gpt_junos {
                sensor StorageTable {
                    where "filesystem-name == '/dev/gpt/junos'";
                    path used-percent;
                }
            }
        field tmpfs {
                sensor StorageTable {
                    where "filesystem-name == 'tmpfs'";
                    path used-percent;
                }
            }
        field var_jails {
                sensor StorageTable {
                    where "filesystem-name == 'var/jails/rest-api'";
                    path used-percent;
                }
            }
        trigger root-file-system {
            term green {
                when {
                    less-than-or-equal-to "$root" 10;
                }
                then {
                    status {
                        color green;
                        message "storage used for root file system is lesser than 10%";
                    }
                }
            }
            term yellow {
                when {
                    less-than-or-equal-to "$root" 75;
                }
                then {
                    status {
                        color yellow;
                        message "storage used for root file system is between 10 and 75%";
                    }
                }
            }
            term red {
                when {
                    greater-than "$root" 75;
                }
                then {
                    status {
                        color red;
                        message "storage used for root file system is greater than 75%";
                    }
                }
            }
        }
        trigger dev-gpt-junos {
                term green {
                    when {
                        less-than-or-equal-to "$dev_gpt_junos" 10;
                    }
                    then {
                        status {
                            color green;
                            message "storage used for dev/gpt/junos is lesser than 10%";
                        }
                    }
                }
                term yellow {
                    when {
                        less-than-or-equal-to "$dev_gpt_junos" 75;
                    }
                    then {
                        status {
                            color yellow;
                            message "storage used for dev/gpt/junos is between 10 and 75%";
                        }
                    }
                }
                term red {
                    when {
                        greater-than "$dev_gpt_junos" 75;
                    }
                    then {
                        status {
                            color red;
                            message "storage used for dev/gpt/junos is greater than 75%";
                        }
                    }
                }
            }
        trigger tmpfs {
                term green {
                    when {
                        less-than-or-equal-to "$tmpfs" 10;
                    }
                    then {
                        status {
                            color green;
                            message "storage used for tmpfs is lesser than 10%";
                        }
                    }
                }
                term yellow {
                    when {
                        less-than-or-equal-to "$tmpfs" 75;
                    }
                    then {
                        status {
                            color yellow;
                            message "storage used for tmpfs is between 10 and 75%";
                        }
                    }
                }
                term red {
                    when {
                        greater-than "$tmpfs" 75;
                    }
                    then {
                        status {
                            color red;
                            message "storage used for tmpfs is greater than 75%";
                        }
                    }
                }
            }
        trigger var-jails {
                term green {
                    when {
                        less-than-or-equal-to "$var_jails" 10;
                    }
                    then {
                        status {
                            color green;
                            message "storage used for var/jails/ is lesser than 10%";
                        }
                    }
                }
                term yellow {
                    when {
                        less-than-or-equal-to "$var_jails" 75;
                    }
                    then {
                        status {
                            color yellow;
                            message "storage used for var/jails/ is between 10 and 75%";
                        }
                    }
                }
                term red {
                    when {
                        greater-than "$var_jails" 75;
                    }
                    then {
                        status {
                            color red;
                            message "storage used for var/jails/ is greater than 75%";
                        }
                    }
                }
            }
        }
    }
    profile storage-profile {
            topics storage;
        }
        device r0edge {
            host 10.221.135.228;
            open-config {
                port 32767;
            }
            authentication {
                password {
                    username regress;
                    password MaRtInI;
                }
            }
        }
        device-group storage {
            devices r0edge;
            profiles storage-profile;
        }
}
