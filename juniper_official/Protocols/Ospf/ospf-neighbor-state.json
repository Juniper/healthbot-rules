{
            "topic" : [
            {
                "topic-name" : "protocol.ospf",
                "description" : "This topic is to monitor ospf neigbor state",
                "synopsis" : "ospf neighbor status check",
                "rule" : [
                {
                    "rule-name" : "check-ospf-neighbor-state",
                    "keys" : ["Address"],
                    "synopsis" : "ospf session state analyzer",
                    "description" : "This rule collects ospf session state periodically and notifies in case of anomalies",
                    "sensor" : [
                    {
                        "sensor-name" : "ospf-neighbor",
                        "synopsis" : "ospf netconf based iAgent sensor definition",
                        "description" : "iAgent sensor defined in yml file using netconf rpc/cli command and defined fields using pyez tables&views to collect data from network device",
                        "iAgent" : {
                            "file" : "ospf-neighbor.yml",
                            "table" : "OspfNeighborTable",
                            "frequency" : "10s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "neighbor-address-expr",
                        "constant" : {
                            "value" : "{{Neighbor_Address}}"
                        },
                        "type" : "string",
                        "description" : "This filed is for ospf neighbor address"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "ospf-neighbor-state",
                        "synopsis" : "ospf neighbor state kpi",
                        "description" : "Sets health based on ospf neighbor state.",
                        "term" : [
                        {
                            "term-name" : "is-neighbor-full",
                            "when" : {
                                "matches-with" : [
                                {
                                    "left-operand" : "$neighbor_state",
                                    "right-operand" : "Full"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "$neighbor_address is in $neighbor_state state"
                                }
                            }
                        },
                        {
                            "term-name" : "is-neighbor-not-full",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$neighbor_address is in $neighbor_state state"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "Neighbor_Address",
                        "value" : ".*",
                        "description" : "Enter required ospf neighbor ids to be monitored usung regular expression",
                        "type" : "string"
                    }
                    ]
                }
                ]
            }
            ],
            "playbook" : [
            {
                "playbook-name" : "ospf-neighbor-state-playbook",
                "rules" : ["protocol.ospf/check-ospf-neighbor-state"],
                "synopsis" : "This playbook is to monitor and notify ospf neighbor state(Up/Down)."
            }
            ]
}
