{
            "topic" : [
            {
                "topic-name" : "system.cpu",
                "description" : "This topic monitors system cpu and sends an alert in case utilization is above thresholds",
                "synopsis" : "system cpu key performance indicators monitoring",
                "rule" : [
                {
                    "rule-name" : "check-system-cpu",
                    "keys" : ["routing-engine"],
                    "synopsis" : "Routing enignes cpu analyzer",
                    "description" : "This rule collects system cpu statistics of REs periodically and notifies in case of anomalies",
                    "function" : [
                    {
                        "function-name" : "subtract",
                        "description" : "function that tweaks thresholds by subtracting them from 100 so that cpu utilization can be found from cpu-idle%",
                        "path" : "system-sensors.py",
                        "method" : "subtract",
                        "argument" : [
                        {
                            "argument-name" : "threshold",
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ],
                    "sensor" : [
                    {
                        "sensor-name" : "components",
                        "synopsis" : "system components open-config sensor definition",
                        "description" : "/components open-config sensor to collect telemetry data from network device",
                        "open-config" : {
                            "sensor-name" : "/components/",
                            "frequency" : "20s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "re-cpu-utilization",
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract",
                                "argument" : [
                                {
                                    "argument" : "threshold",
                                    "value" : "$re-cpu-utilization-oc"
                                }
                                ]
                            }
                        },
                        "type" : "integer",
                        "description" : "This field derives used percentage from idle cpu utilization"
                    },
                    {
                        "field-name" : "re-cpu-utilization-higher-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for re cpu utilization higher threshold value"
                    },
                    {
                        "field-name" : "re-cpu-utilization-lower-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for re cpu utilization lower threshold value"
                    },
                    {
                        "field-name" : "re-cpu-utilization-oc",
                        "sensor" : [
                        {
                            "sensor-name" : "components",
                            "where" : "/components/component/properties/property/@name == 'cpu-utilization-idle'",
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ],
                        "description" : "This field is for re cpu idle utilization"
                    },
                    {
                        "field-name" : "routing-engine",
                        "sensor" : [
                        {
                            "sensor-name" : "components",
                            "where" : "/components/component/@name =~ /^Routing Engine[{{RE_Slot_No}}]*$/",
                            "path" : "/components/component/@name"
                        }
                        ],
                        "description" : "This field is for re identification"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "re-cpu-utilization",
                        "synopsis" : "Routing engine cpu kpi",
                        "description" : "Sets health based on RE cpu utilization thresholds.",
                        "term" : [
                        {
                            "term-name" : "is-re-cpu-utilization-normal",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-cpu-utilization",
                                    "right-operand" : "$re-cpu-utilization-lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "$routing-engine cpu utilization($re-cpu-utilization) is lesser than lower threshold($re-cpu-utilization-lower-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-re-cpu-utilization-median",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-cpu-utilization",
                                    "right-operand" : "$re-cpu-utilization-higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : " $routing-engine cpu utilization($re-cpu-utilization) is in medium range"
                                }
                            }
                        },
                        {
                            "term-name" : "re-cpu-utilization-abnormal",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$routing-engine cpu utilization($re-cpu-utilization) is greater than higher threshold($re-cpu-utilization-higher-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "RE_Slot_No",
                        "value" : "0-1",
                        "description" : "Enter RE slot numbers using regular expression",
                        "type" : "string"
                    },
                    {
                        "name" : "re_cpu_higher_threshold",
                        "value" : "75",
                        "description" : "Enter RE cpu higher threshol value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_lower_threshold",
                        "value" : "50",
                        "description" : "Enter RE cpu lower threshol value",
                        "type" : "int"
                    }
                    ]
                },
                {
                    "rule-name" : "check-system-cpu-load-average",
                    "keys" : ["slot"],
                    "synopsis" : "RE cpu load average analyzer",
                    "description" : "This rule collects RE cpu load average data periodically and notifies in case of anomalies",
                    "function" : [
                    {
                        "function-name" : "subtract",
                        "description" : "function that tweaks thresholds by subtracting them from 100 so that cpu utilization can be found from cpu-idle%",
                        "path" : "system-sensors.py",
                        "method" : "subtract",
                        "argument" : [
                        {
                            "argument-name" : "threshold",
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ],
                    "sensor" : [
                    {
                        "sensor-name" : "CPUutilizationTable",
                        "synopsis" : "Routing engines CPU iAgent sensor definition",
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device",
                        "iAgent" : {
                            "file" : "system-cpu.yml",
                            "table" : "CPUutilizationTable",
                            "frequency" : "10s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "cpu-15min",
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract",
                                "argument" : [
                                {
                                    "argument" : "threshold",
                                    "value" : "$cpu-idle-15min"
                                }
                                ]
                            }
                        },
                        "type" : "integer",
                        "description" : "This field derives used percentage from idle cpu utilization"
                    },
                    {
                        "field-name" : "cpu-1min",
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract",
                                "argument" : [
                                {
                                    "argument" : "threshold",
                                    "value" : "$cpu-idle-1min"
                                }
                                ]
                            }
                        },
                        "type" : "integer",
                        "description" : "This field derives used percentage from idle cpu utilization"
                    },
                    {
                        "field-name" : "cpu-5min",
                        "formula" : {
                            "user-defined-function" : {
                                "function-name" : "subtract",
                                "argument" : [
                                {
                                    "argument" : "threshold",
                                    "value" : "$cpu-idle-5min"
                                }
                                ]
                            }
                        },
                        "type" : "integer",
                        "description" : "This field derives used percentage from idle cpu utilization"
                    },
                    {
                        "field-name" : "cpu-utilization-15min-higher-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_15min_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 15 minutes load average higher threshold"
                    },
                    {
                        "field-name" : "cpu-utilization-15min-lower-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_15min_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 15 minutes load average lower threshold"
                    },
                    {
                        "field-name" : "cpu-utilization-1min-higher-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_1min_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 1 minute load average higher threshold"
                    },
                    {
                        "field-name" : "cpu-utilization-1min-lower-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_1min_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 1 minute load average lower threshold"
                    },
                    {
                        "field-name" : "cpu-utilization-5min-higher-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_5min_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 5 minutes load average higher threshold"
                    },
                    {
                        "field-name" : "cpu-utilization-5min-lower-threshold",
                        "constant" : {
                            "value" : "{{re_cpu_5min_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "RE cpu utilization 5 minutes load average lower threshold"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "cpu-utilization-15min",
                        "synopsis" : "RE cpu 15 mins load average kpi",
                        "description" : "Sets health based on RE cpu 15 mminutes load average threshold.",
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-15min-normal",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-15min",
                                    "right-operand" : "$cpu-utilization-15min-lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "Routing Engine$slot 15min cpu utilization($cpu-15min) is lesser than lower threshold($cpu-utilization-15min-lower-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-cpu-utilization-15min-median",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-15min",
                                    "right-operand" : "$cpu-utilization-15min-higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "Routing Engine$slot 15min cpu utilization($cpu-15min) is in medium range"
                                }
                            }
                        },
                        {
                            "term-name" : "cpu-utilization-15min-abnormal",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "Routing Engine$slot  15min cpu utilization($cpu-15min) is greater than higher threshold($cpu-utilization-15min-higher-threshold)"
                                }
                            }
                        }
                        ]
                    },
                    {
                        "trigger-name" : "cpu-utilization-1min",
                        "synopsis" : "RE cpu 1 mins load average kpi",
                        "description" : "Sets health based on RE cpu 1 mminute load average threshold.",
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-1min-normal",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-1min",
                                    "right-operand" : "$cpu-utilization-1min-lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "Routing Engine$slot 1min cpu utilization($cpu-1min) is lesser than lower threshold($cpu-utilization-1min-lower-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-cpu-utilization-1min-median",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-1min",
                                    "right-operand" : "$cpu-utilization-1min-higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "Routing Engine$slot  1min cpu utilization($cpu-1min) is in medium range"
                                }
                            }
                        },
                        {
                            "term-name" : "cpu-utilization-1min-abnormal",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "Routing Engine$slot 1min cpu utilization($cpu-1min) is greater than higher threshold(cpu-utilization-1min-higher-threshold)"
                                }
                            }
                        }
                        ]
                    },
                    {
                        "trigger-name" : "cpu-utilization-5min",
                        "synopsis" : "RE cpu 5 mins load average kpi",
                        "description" : "Sets health based on RE cpu 5 mminutes load average threshold.",
                        "term" : [
                        {
                            "term-name" : "is-cpu-utilization-5min-normal",
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-5min",
                                    "right-operand" : "$cpu-utilization-5min-lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "Routing Engine$slot 5min cpu utilization($cpu-5min) is lesser than lower threshold($cpu-utilization-5min-lower-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-cpu-utilization-5min-median",
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$cpu-5min",
                                    "right-operand" : "$cpu-utilization-5min-higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "Routing Engine$slot 5min cpu utilization($cpu-5min) is in medium range"
                                }
                            }
                        },
                        {
                            "term-name" : "cpu-utilization-5min-abnormal",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "Routing Engine$slot 5min cpu utilization($cpu-5min) is greater than higher threshold($cpu-utilization-5min-higher-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "re_cpu_15min_higher_threshold",
                        "value" : "75",
                        "description" : "Enter re cpu 15 mins load average higher threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_15min_lower_threshold",
                        "value" : "50",
                        "description" : "Enter re cpu 15 mins load average lower threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_1min_higher_threshold",
                        "value" : "85",
                        "description" : "Enter re cpu 1 min load average higher threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_1min_lower_threshold",
                        "value" : "60",
                        "description" : "Enter re cpu 1 mins load average lower threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_5min_higher_threshold",
                        "value" : "80",
                        "description" : "Enter re cpu 5 mins load average higher threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "re_cpu_5min_lower_threshold",
                        "value" : "55",
                        "description" : "Enter re cpu 5 mins load average lower threshold value",
                        "type" : "int"
                    }
                    ]
                }
                ]
            },
            {
                "topic-name" : "system.memory",
                "description" : "This topic is to monitor and notify  RE system memory",
                "synopsis" : "RE system memory statistics analyzer",
                "rule" : [
                {
                    "rule-name" : "check-system-memory",
                    "keys" : ["routing-engine"],
                    "synopsis" : "RE system memory statistics analyzer",
                    "description" : "This rule collects REs system cpu statistics periodically and notifies in case of anomalies",
                    "sensor" : [
                    {
                        "sensor-name" : "components",
                        "synopsis" : "system components open-config sensor definition",
                        "description" : "RE system open-config sensor to collect telemetry data from network device",
                        "open-config" : {
                            "sensor-name" : "/components/",
                            "frequency" : "20s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "re-memory-buffer",
                        "sensor" : [
                        {
                            "sensor-name" : "components",
                            "where" : "/components/component/properties/property/@name == 'memory-utilization-buffer'",
                            "path" : "/components/component/properties/property/state/value"
                        }
                        ],
                        "type" : "integer",
                        "description" : "This field is for RE system memory buffer"
                    },
                    {
                        "field-name" : "re-memory-buffer-higher-threshold",
                        "constant" : {
                            "value" : "{{memory_buffer_re_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for RE system memory buffer higher threshold"
                    },
                    {
                        "field-name" : "re-memory-buffer-lower-threshold",
                        "constant" : {
                            "value" : "{{memory_buffer_re_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for RE system memory buffer lower threshold"
                    },
                    {
                        "field-name" : "routing-engine",
                        "sensor" : [
                        {
                            "sensor-name" : "components",
                            "where" : "/components/component/@name =~ /^Routing Engine[{{RE_Slot_No}}]*$/",
                            "path" : "/components/component/@name"
                        }
                        ],
                        "type" : "string",
                        "description" : "This field is for routing-engine"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "re-memory-buffer-utilization",
                        "synopsis" : "RE system memory buffer utilization kpi",
                        "description" : "Sets health based on lldp system memory buffer utilization state.",
                        "term" : [
                        {
                            "term-name" : "green",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-memory-buffer",
                                    "right-operand" : "$re-memory-buffer-lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "$routing-engine memory buffer utilization($re-memory-buffer) is lesser than lower threshold($re-memory-buffer-lower-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "yellow",
                            "when" : {
                                "less-than-or-equal-to" : [
                                {
                                    "left-operand" : "$re-memory-buffer",
                                    "right-operand" : "$re-memory-buffer-higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "$routing-engine memory buffer utilization($re-memory-buffer) is in medium range(>=$re-memory-buffer-lower-threshold, <=$re-memory-buffer-higher-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "red",
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$routing-engine memory buffer utilization($re-memory-buffer) is greater than higher threshold($re-memory-buffer-higher-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "RE_Slot_No",
                        "value" : "0-1",
                        "description" : "Enter RE slot numbers using regular expression",
                        "type" : "string"
                    },
                    {
                        "name" : "memory_buffer_re_higher_threshold",
                        "value" : "60",
                        "description" : "Enter RE memory buffer higher threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "memory_buffer_re_lower_threshold",
                        "value" : "20",
                        "description" : "Enter RE memory buffer lower threshold value",
                        "type" : "int"
                    }
                    ]
                }
                ]
            },
            {
                "topic-name" : "system.processes",
                "description" : "This topic is to monitor and notify cpu, memory utilization of junos system processes",
                "synopsis" : "system processes(daemons) cpu&memory analyzer",
                "rule" : [
                {
                    "rule-name" : "check-process-cpu",
                    "keys" : ["daemon"],
                    "synopsis" : "system processes cpu analyzer",
                    "description" : "This rule collects system process's cpu utilization periodically and notifies in case of anomalies",
                    "sensor" : [
                    {
                        "sensor-name" : "SystemProcExtTable",
                        "synopsis" : "System processes CPU iAgent sensor definition",
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device",
                        "iAgent" : {
                            "file" : "system-proc-ext.yml",
                            "table" : "SystemProcExtTable",
                            "frequency" : "10s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "cpu-util-percent",
                        "sensor" : [
                        {
                            "sensor-name" : "SystemProcExtTable",
                            "path" : "wcpu"
                        }
                        ],
                        "description" : "This field shows cpu utilization for corresponding processes"
                    },
                    {
                        "field-name" : "daemon",
                        "sensor" : [
                        {
                            "sensor-name" : "SystemProcExtTable",
                            "path" : "cmd"
                        }
                        ],
                        "description" : "This field is to parse all junos processes names"
                    },
                    {
                        "field-name" : "max-threshold",
                        "constant" : {
                            "value" : "{{process_cpu_max_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for processes cpu maximum threshold value"
                    },
                    {
                        "field-name" : "min-threshold",
                        "constant" : {
                            "value" : "{{process_cpu_min_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for processes cpu minimum threshold value"
                    },
                    {
                        "field-name" : "process-name",
                        "constant" : {
                            "value" : "{{process_name}}"
                        },
                        "type" : "string",
                        "description" : "This field shows processes to be monitored"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "processe-cpu-utilization",
                        "synopsis" : "system prcoesses cpu utilization kpi",
                        "description" : "Sets health based on system processes cpu utilization.",
                        "term" : [
                        {
                            "term-name" : "is-processes-not-found",
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$daemon",
                                    "right-operand" : "$process-name"
                                }
                                ]
                            }
                        },
                        {
                            "term-name" : "is-cpu-utilization-abnormal",
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-util-percent",
                                    "right-operand" : "$max-threshold",
                                    "time-range" : "30s"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$daemon cpu utilization:($cpu-util-percent), crossed higher threshold($max-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-cpu-utilization-median",
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$cpu-util-percent",
                                    "right-operand" : "$min-threshold",
                                    "time-range" : "30s"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "$daemon cpu utilization:($cpu-util-percent), crossed medium threshold($min-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "process_cpu_max_threshold",
                        "value" : "70",
                        "description" : "Enter processes cpu maximum threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "process_cpu_min_threshold",
                        "value" : "50",
                        "description" : "Enter processes cpu minimum threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "process_name",
                        "value" : ".*",
                        "description" : "Enter processes to be monitored using regular expression with seperator option",
                        "type" : "string"
                    }
                    ]
                },
                {
                    "rule-name" : "check-process-memory",
                    "keys" : ["daemon"],
                    "synopsis" : "system processes memory utilization analyzer",
                    "description" : "This rule collects system process's memory utilization periodically and notifies in case of anomalies",
                    "function" : [
                    {
                        "function-name" : "isExceeding",
                        "description" : "This function isExceeding returns 'True' if % of size used out of reserved memory is not exceeding the threshold",
                        "path" : "system-processes.py",
                        "method" : "isExceeding",
                        "argument" : [
                        {
                            "argument-name" : "res",
                            "mandatory" : [null]
                        },
                        {
                            "argument-name" : "size",
                            "mandatory" : [null]
                        },
                        {
                            "argument-name" : "threshold",
                            "mandatory" : [null]
                        }
                        ]
                    }
                    ],
                    "sensor" : [
                    {
                        "sensor-name" : "SystemProcExtTable",
                        "synopsis" : "System processes memory iAgent sensor definition",
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device",
                        "iAgent" : {
                            "file" : "system-proc-ext.yml",
                            "table" : "SystemProcExtTable",
                            "frequency" : "10s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "daemon",
                        "sensor" : [
                        {
                            "sensor-name" : "SystemProcExtTable",
                            "path" : "cmd"
                        }
                        ],
                        "description" : "This field is to parse all junos processes names"
                    },
                    {
                        "field-name" : "max-threshold",
                        "constant" : {
                            "value" : "{{process_memory_max_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for processes memory maximum threshold value"
                    },
                    {
                        "field-name" : "min-threshold",
                        "constant" : {
                            "value" : "{{process_memory_min_threshold}}"
                        },
                        "type" : "integer"
                    },
                    {
                        "field-name" : "process-name",
                        "constant" : {
                            "value" : "{{process_name}}"
                        },
                        "type" : "string",
                        "description" : "This field shows processes to be monitored"
                    },
                    {
                        "field-name" : "reserved",
                        "sensor" : [
                        {
                            "sensor-name" : "SystemProcExtTable",
                            "path" : "res"
                        }
                        ],
                        "description" : "This field is for reserved memory"
                    },
                    {
                        "field-name" : "size",
                        "sensor" : [
                        {
                            "sensor-name" : "SystemProcExtTable",
                            "path" : "size"
                        }
                        ],
                        "description" : "This field is for processes memory size"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "processes-memory-utilization",
                        "term" : [
                        {
                            "term-name" : "skiping-undefined-processes",
                            "when" : {
                                "does-not-match-with" : [
                                {
                                    "left-operand" : "$daemon",
                                    "right-operand" : "$process-name"
                                }
                                ]
                            }
                        },
                        {
                            "term-name" : "is-memory-utilization-abnormal",
                            "when" : {
                                "user-defined-function" : [
                                {
                                    "function-name" : "isExceeding",
                                    "argument" : [
                                    {
                                        "argument" : "size",
                                        "value" : "$size"
                                    },
                                    {
                                        "argument" : "res",
                                        "value" : "$reserved"
                                    },
                                    {
                                        "argument" : "threshold",
                                        "value" : "$max-threshold"
                                    }
                                    ],
                                    "time-range" : "30s"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$daemon memory utilization is above higher threshold($max-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-memory-utilization-median",
                            "when" : {
                                "user-defined-function" : [
                                {
                                    "function-name" : "isExceeding",
                                    "argument" : [
                                    {
                                        "argument" : "size",
                                        "value" : "$size"
                                    },
                                    {
                                        "argument" : "res",
                                        "value" : "$reserved"
                                    },
                                    {
                                        "argument" : "threshold",
                                        "value" : "$min-threshold"
                                    }
                                    ],
                                    "time-range" : "30s"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "$daemon memory utilization is in medium range(>=$min-threshold, <=$max-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "process_memory_max_threshold",
                        "value" : "70",
                        "description" : "Enter processes memory maximum threshold values if default value not matches with your requirement",
                        "type" : "int"
                    },
                    {
                        "name" : "process_memory_min_threshold",
                        "value" : "50",
                        "description" : "Enter processes memory minimum threshold values if default value not matches with your requirement",
                        "type" : "int"
                    },
                    {
                        "name" : "process_name",
                        "value" : ".*",
                        "description" : "Enter processes to be monitored with separator or leave it to default",
                        "type" : "string"
                    }
                    ]
                }
                ]
            },
            {
                "topic-name" : "system.storage",
                "description" : "This topic is to monitor system disk partitions mount usage and notify in case storage is above threshold",
                "synopsis" : "system storage usage analyzer",
                "rule" : [
                {
                    "rule-name" : "check-storage",
                    "keys" : ["filesystem-name"],
                    "synopsis" : "system storage usage analyzer",
                    "description" : "This rule collects disk storage usage periodically and notifies in case of anomalies",
                    "sensor" : [
                    {
                        "sensor-name" : "StorageTable",
                        "synopsis" : "System storage iAgent sensor definition",
                        "description" : "iAgent netconf rpc/cli command sensor to collect data from network device",
                        "iAgent" : {
                            "file" : "system-storage.yml",
                            "table" : "StorageTable",
                            "frequency" : "20s"
                        }
                    }
                    ],
                    "field" : [
                    {
                        "field-name" : "higher-threshold",
                        "constant" : {
                            "value" : "{{storage_usage_higher_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for storage usage higher threshold"
                    },
                    {
                        "field-name" : "lower-threshold",
                        "constant" : {
                            "value" : "{{storage_usage_lower_threshold}}"
                        },
                        "type" : "integer",
                        "description" : "This field is for storage usage lower threshold"
                    }
                    ],
                    "trigger" : [
                    {
                        "trigger-name" : "fs-utilization",
                        "synopsis" : "File system usage kpi",
                        "description" : "Sets health based on file system storage usage.",
                        "term" : [
                        {
                            "term-name" : "is-system-storage-abnormal",
                            "when" : {
                                "greater-than-or-equal-to" : [
                                {
                                    "left-operand" : "$used-percent",
                                    "right-operand" : "$higher-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "red",
                                    "message" : "$filesystem-name storage used($used-percent) is above ($higher-threshold)"
                                }
                            }
                        },
                        {
                            "term-name" : "is-system-storage-normal",
                            "when" : {
                                "less-than" : [
                                {
                                    "left-operand" : "$used-percent",
                                    "right-operand" : "$lower-threshold"
                                }
                                ]
                            },
                            "then" : {
                                "status" : {
                                    "color" : "green",
                                    "message" : "$filesystem-name storage used($used-percent) is normal ($used-percent)"
                                }
                            }
                        },
                        {
                            "term-name" : "system-storage-median",
                            "then" : {
                                "status" : {
                                    "color" : "yellow",
                                    "message" : "$filesystem-name storage used($used-percent) is in medium range(>=$lower-threshold, <=$higher-threshold)"
                                }
                            }
                        }
                        ]
                    }
                    ],
                    "variable" : [
                    {
                        "name" : "storage_usage_higher_threshold",
                        "value" : "70",
                        "description" : "Enter partition usage higher threshold value",
                        "type" : "int"
                    },
                    {
                        "name" : "storage_usage_lower_threshold",
                        "value" : "50",
                        "description" : "Enter partition usage lower threshold value",
                        "type" : "int"
                    }
                    ]
                }
                ]
            }
            ],
            "playbook" : [
            {
                "playbook-name" : "system-kpis-playbook",
                "rules" : ["system.cpu/check-system-cpu", "system.cpu/check-system-cpu-load-average", "system.memory/check-system-memory", "system.processes/check-process-cpu", "system.processes/check-process-memory", "system.storage/check-storage"],
                "description" : "This playbook takes min, max thresholds as input and monitors system cpu, memory, storage and junos processes cpu and memory utilization",
                "synopsis" : "System key performance indicators"
            }
            ]

}